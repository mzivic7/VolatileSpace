### more orbital parameters ###
Pe = a * (1 - e)   # periapsis distance from planet center
Ap = a * (1 + e)   # apoapsis distance from planet center
Pev = [Pe * cos(omega + pi) + P1_x, Pe * sin(omega + pi) + P1_y]   # periapsis vector
Apv = [Ap * cos(omega), Ap * sin(omega)]   # apoapsis vector
T = 2 * pi * sqrt(a^3 / u)   # orbital period [7]
Ta = atan2(Pr_y, Pr_x)   # true anomaly from relative position in -pi to pi range (angle between horizont and body)
Ta = (omega - Ta - pi)%(2pi)   # this puts true anomaly in right quadrants and adds argument of Pe
moment = rel_pos cross rel_vel   # rotation moment
direction = sign(moment)   # if moment is negative, rotation is clockwise (-1)
if direction is -1:
    Ta = 2pi - Ta   # invert Ta to be calculated in opposite direction
Lat = (Ta - omega) * 180 / pi   # latitude
d = |Pr|   # distance
vo = |vr|   # orbit speed
angle = 2pi - Ta + omega
vv = (vr_x * cos(angle) + vr_y * sin(angle))   # vertical speed
vh = abs(vr_x * sin(angle) - vr_y * cos(angle))   # horizontal speed
# Vertical and horizontal speeds are calculated as components of vr, but coordinate system is rotated by pi/2-true_anomaly - to be normal with body position vector relative to orbiting mass.

# if direction is clockwise invert Ta to be calculated in opposite direction
if direction == -1:
    true_anomaly = 2pi - true_anomaly


References:
[7] https://en.wikipedia.org/wiki/Orbital_period#Small_body_orbiting_a_central_body

